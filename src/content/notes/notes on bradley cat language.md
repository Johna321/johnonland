---
title: notes on bradley cat language
draft: true
---

## intro
uses the verbiage that LLMs "learn the probability distribution" on possible continuations of a given text. asserts that the ability to continue a story requires mastery of "syntax, pronoun matching, POS awareness, etc", then that these models must have learned *some* semantic knowledge. 

immediately brings syntax <-> semantics relationship to mind (structure <-> function). hunch is that this will be the theme of the paper. 

"the present work is a response to the real-world evidence that it is possible to pass from probability distributions on text continuations to semantic information"

define a **syntax category** *enriched* over the unit-interval $[0,1]$ that models probability distributions on text continuations. 
### diatribe on *enrichment*: 
for objects $x, y$ we naturally have a **set** $\text{Hom}(x, y)$. but if we fix a *monoidal* category $(\mathcal{V}, \otimes, I)$,  a **$\mathcal{V}$-enriched category** has 
$$
\text{Hom}_{\mathcal{C}}(x,y) \in \text{Ob}(\mathcal{V})
$$
with *compositions* as *morphisms* in $\mathcal{V}$ :
$$
\text{Hom}(y, z) \otimes \text{Hom}(x, y) \rightarrow \text{Hom}(x, z)
$$
and identities $I \rightarrow \text{Hom}(x, x)$ 

the unit interval $I = [0,1]$ can be given monoidal structure, for example:
$$
\mathcal{V} = \left( [0,1], \geq, \cdot, 1 \right)
$$
which gives us fuzzy preorders / probabilistic metric spaces. so a category enriched over the unit interval means:
- each "hom" is a number in $[0,1]$
- $1$ acts as "identity" (perfect truth)
- composition is defined via multiplication
- inequalities replaces equalities (?)

### back to intro
bradley's **semantic category** is defined as the *enriched category* of $[0,1]$-valued *copresheaves* on the **syntax category**. so something like
$$
\mathsf{Sem} \;:=\; [\,\mathsf{Syn}, [0,1]\,]_{[0,1]}
$$
the *yoneda embedding*, which maps Syn as a subcategory of Sem, assigns to a given text its *representable cosheaf*. we regard the $[0,1]$-valued copresheaf represented by a text as the "meaning of the text" in the sense of *dynamic semantics* where "meaning is the context change potential"

### compositionality 
can consider language as the free monoid on some set of atomic symbols quotiented by the ideal of all expressions that are not gramatically correct; or perhaps something resembling the tree-like structures of parsed texts, labelled with classes that can be assembled by some set of grafting rules. in either case, you might identify the meaning of some word with the principal ideal of all expressions containing that word. if one knows every expression that contains a word, one understands the meaning of that word. 

construct a space whose points are ideals and view the algebraic structure as a sort of coordinate algebra on a space of meanings. further, you can model semantics via sheaves on this space of meanings, as Lawvere did in 1969 paper on syntax-semantic duality. 

more than compositionality, we need to account for the distribution of meaningful texts. 
	i.e. there's a reason that "red firetruck" is more common than "green firetruck". 
this is the *distributional hypothesis* in linguistics. 

formalize a marriage of the composition and distribution with category $\mathcal{L}$, then pass to the category of enriched copresheaves on $\mathcal{L}$, whose objects are *unit interval valued functions on $\mathcal{L}$ satisfying a monotonicity condition*. this category $\hat{\mathcal{L}}$ is the semantic category. 

note: DisCoCat has similar aims, but requires choice of grammar as input. in this paper, syntactical structures are inherent within the enriched category theory, no input required (inspired by LLMs not needing grammar rules as input, all important grammatical information is *already contained* in the enriched category). 

### why cat theory?
consider category w/ objects as elements of free monoid on finite set of symbols, where there is a morphism $x \to y$ whenever $x$ is a substring of $y$, i.e. when $y$ is a *continuation* of $x$. 
(free monoid -> set of all finite strings formed by concatenation).

yoneda lemma implies that a fixed object in this category is *determined up to isomorphism* by the totality of its relationships to other objects in the category. so think of identifying an object $x$ with the functor $h^x := \text{Hom}(x, -)$ whose value on an expression $y$ is the *one-point set* $*$ if $x$ contained in $y$ and is empty set otherwise. this functor $h^x$ is an example of a *copresheaf*: a functor from a given category to the category of sets. this is further a *representable* copresheaf, represented by the object $x$. thus, the *preimage* of $*$ is precisely the *principal ideal* generated by $x$. *representable cospresheaves* <-> *principal ideals*.


### constructions in unenriched setting
immediate advantage is that $\hat{\mathcal{C}} := \textbf{Set}^{\mathcal{C}}$ has all limits and colimits, and is cartesian closed. in fact, the category of presheaves is a *topos*, the appropriate setting for intuitionistic logic. 

here **products** are like categorical **and**; **coproducts** are like categorical **or**. 
$$
\begin{align}
c \to h^{\text{red}}(c) &\sqcup h^{\text{blue}}(c), c \in \text{Ob}(\mathcal{L}) \ \ \ \text{(coproduct)} \\
c \to h^{\text{red}}(c) &\times h^{\text{blue}}(c), c \in \text{Ob}(\mathcal{L}) \ \ \ \text{(product)}
\end{align}
$$

## enriched cat theory

### syntax category

**def 4**. we define the syntax category $\mathcal{L}$ to be the category enriched over $[0,1]$ whose objects are *expression in the language* and where $[0,1]$-objects are defined by:
$$
\mathcal{L}(x, y) := \pi(y|x)
$$
where $\pi(y|x)$ denotes the *probability* that $y$ extends $x$. i.e. if $x$ is *not* a subtext of $y$, then $\pi(y|x) = 0$. 

**def 5**. supposed $\mathcal{C}$ and $\mathcal{D}$ are categories enriched over a *commutative monoidal preorder* $(\mathcal{V}, \otimes, \leq, 1)$. an *enriched functor* $\mathcal{C} \to \mathcal{D}$ is a function $f: \mathcal{C} \to \mathcal{D}$ satisfying 
$$
\mathcal{C}(x, y) \leq \mathcal{D}(f_x, f_y)
$$
for *all objects* $x$ and $y$ in $\mathcal{C}$

**def 6.** suppose $\mathcal{C}$ is a category enriched over a closed commutative monoidal preorder $\mathcal{V}$. an *enriched copresheaf* is a function $f: \mathcal{C} \to \mathcal{V}$ satisfying
$$
\mathcal{C}(x, y) \leq \mathcal{V}(f_x, f_y)
$$
for *all objects* $x$ and $y$ in $\mathcal{C}$

now to make this enriched category whose objects are V-functors from C to D, we need a hom object D^C in V between any two such functors f,g: C -> D. formally this is defined by an *end*, which is a particular kind of limit in $\mathcal{V}$
$$
\mathcal{D}^{\mathcal{C}}(f, g) := \int_{c \in \mathcal{C}} \mathcal{D}(fc, gc)
$$
